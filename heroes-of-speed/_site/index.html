<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Heroes Of Speed</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="user-scalable=no, width=device-width" />
		<meta http-equiv="Cache-Control" content="no-cache" />
		<style type="text/css">
@font-face {
	font-family: DigitaldreamFatSkewNarrow;
	src: url('DigitaldreamFatSkewNarrow.ttf');
}

@font-face {
    font-family: 'SpeakComp-Heavy';
    src: url('//heroesofspeed.de/skin/fonts/SpeakComp-Heavy.ttf');
    font-style: normal;
    font-weight: normal;
}

html {
	overflow: hidden;
}

body {
	margin: 0;
	min-height: 504px;
	font-family: DigitaldreamFatSkewNarrow;
	color: green;
	overflow: hidden;
	background-size: 100% auto;
}

#container {
	position: absolute;
	width: 100%;
	height: 120%;
	overflow: hidden;
	background-size: 100% auto;
	text-align: center;
}

#erasable {
	background-image: url(dirt2.jpg);
	background-size: 100%;
	opacity: 0;
	-webkit-transition: opacity 0.6s ease-in;
	width: 100%;
	top: 0;
}

#ice {
	background-image: url(dirt2.jpg);
	opacity: 0.8;
	position: absolute;
	top: 0;
	width: 100%;
	height: 568px;
}

#cta {
	font-family: 'SpeakComp-Heavy';
	position: absolute;
	top: 190px;
	color: white;
	font-size: 26px;
	width: 100%;
	height: 50px;
	display: none;
	text-align: center;
	padding: 0;
	text-shadow: 0 0 5px black;
}

#timer {
	display: none;
	position: absolute;
	top: 270px;
	font-size: 24px;
	color: white;
	text-align: center;
	width: 100%;
}

#results {
	position: absolute;
	overflow: hidden;
	top: 0;
	display: none;
	width: 100%;
	height: 120%;
	text-align: center;
	color: green;
	-webkit-transition: opacity 1s ease-in;
}

#white-layer {
	-webkit-transition: opacity 1s ease-in;
	background-image: url(bg_main.jpg);
	background-size: 720px;
	width: 100%;
	height: 100%;
	opacity: 0;
}

#das-waren {
	font-family: 'SpeakComp-Heavy';
	-webkit-transition: all 1s ease-in;
	-webkit-transform: scale(100);
	top: 175px;
	font-size: 30px;
	position: absolute;
	width: 100%;
	left: 0;
	opacity: 0;
	color: #814e97;
}

#total-seconds {
	-webkit-transition: all 1s ease-in 1s;
	-webkit-transform: scale(100);
	top: 190px;
	font-size: 58px;
	position: absolute;
	width: 100%;
	left: 0;
	opacity: 0;
}

#sekunden {
	font-family: 'SpeakComp-Heavy';
	-webkit-transition: all 1s ease-in 2s;
	-webkit-transform: scale(100);
	top: 280px;
	font-size: 30px;
	position: absolute;
	width: 100%;
	left: 0;
	opacity: 0;
	color: #814e97;
}

#conclusion {
	font-family: 'SpeakComp-Heavy';
	-webkit-transition: all 1s ease-in 2.5s;
	-webkit-transform: scale(100);
	top: 340px;
	font-size: 15px;
	position: absolute;
	width: 100%;
	left: 0;
	opacity: 0;
	color: #814e97;
}

.zoom-out {
	-webkit-transition: all 0.5s ease-in;
}

#logo {
	-webkit-transition: opacity 0.5s ease-in 4s;
	position: absolute;
	top: 30px;
	margin-top: 30px;
	width: 200px;
	opacity: 0;
	pointer-events:none;
}

a.green-button {
	-webkit-transition: opacity 0.5s ease-in 4s;
	position: absolute;
	text-decoration: none;
    background: url(btn_green.png) no-repeat scroll 0 0 transparent;
    color: #FFFFFF;
    display: block;
    font-family: 'SpeakComp-Heavy';
    font-size: 25px;
    height: 65px;
    line-height: 30px;
    padding: 5px 22px;
    text-align: center;
    width: 244px;
	top: 0;
	left: -20px;
	opacity: 0;
	-webkit-transform: scale(0.75);
	pointer-events:none;
}

#kabel-bw {
	-webkit-transition: opacity 0.5s ease-in 4s;
	position: absolute;
	top: 14px;
	width: 50px;
	left: 250px;
	opacity: 0;
}

#bottom {
	position: absolute;
	top: 430px;
	width: 320px;
	height: 75px;
}

@media only screen and (max-device-height: 480px) {
	#logo {
		top: 7px;
	}

	#das-waren {
		top: 120px;
	}

	#total-seconds {
		top: 135px;
	}

	#sekunden {
		top: 220px;
	}

	#bottom {
		top: 341px;
	}

	#conclusion {
		top: 280px;
	}
}
		</style>
	</head>
	<body>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-41094613-1', 'yoc-ag.github.io');
		ga('send', 'pageview');
	</script>
<div id="container">
	<canvas id="erasable" width="640" height="1136"></canvas>
	<p id="cta">Wisch' jetzt schnell dein Display sauber!</p>
	<p id="timer"><span id="minutes"></span>:<span id="seconds"></span>:<span id="hundredths"></span> (<span id="ratio">00%</span>)</p>
	<div id="results">
		<div id="white-layer"></div>
		<p id="das-waren" class="zoom-out">Du hast</p>
		<p id="total-seconds">?</p></p>
		<p id="sekunden">Sekunden gebraucht.</p>
		<p id="conclusion">Das ist Hero of Speed verd√§chtig.</p>
	</div>
	<img id="logo" src="http://www.heroesofspeed.de/skin/img/logo_hos_1.png"/>
	<div id="bottom">
		<a id="button" href="//heroesofspeed.de" class="green-button" title="Schnell mitmachen und gewinnen">Jetzt Hero of Speed <span>werden und gewinnen!</span></a>
		<img id="kabel-bw" src="logo.png"/>
	</div>
</div>
		<script>
/*jslint browser: true, devel: true*/
/*global ga*/

var erasableEl = document.getElementById("erasable"),
    ctaEl = document.getElementById("cta"),
    timerEl = document.getElementById("timer"),
    ratioEl = document.getElementById("ratio"),
    minutesEl = document.getElementById("minutes"),
    secondsEl = document.getElementById("seconds"),
    hundredthsEl = document.getElementById("hundredths"),
    resultsEl = document.getElementById("results"),
    totalSecondsEl = document.getElementById("total-seconds"),
    dasWarenEl = document.getElementById("das-waren"),
    sekunden = document.getElementById("sekunden"),
    whiteLayerEl = document.getElementById("white-layer"),
    logoEl = document.getElementById("logo"),
    buttonEl = document.getElementById("button"),
    kabelBwEl = document.getElementById("kabel-bw"),
    conclusionEl = document.getElementById("conclusion"),
    containerEl = document.getElementById("container"),
    bottomEl = document.getElementById("bottom"),

    context = erasableEl.getContext("2d"),
    interval,
    containerX,
    containerY,

    initialOpacity = 0.6,

    matrix = [],
    totalPoints = 320 * 568,
    points = 0,
    ratio = 0,

    didWipe = false,

    screenHeight = screen.height >= 568 ? 568 : 480,

    get_param = function (name) {
        "use strict";
        return decodeURI(
            (new RegExp(name + '=' + '(.+?)(&|$)').exec(location.search) || [null])[1]
        );
    },

    pad = function (val) {
        "use strict";

        var valString = val.toString();

        if (valString.length < 2) {
            return "0" + valString;
        }

        return valString;
    },

    mark = function(x, y) {
        "use strict";
        var i, j;

        for (i = x - 20; i < x + 20; i = i + 1) {
            if (!matrix[i]) {
                matrix[i] = [];
            }

            for (j = y - 20; j < y + 20; j = j + 1) {
                if (matrix[i][j] !== true) {
                    matrix[i][j] = true;
                    points = points + 1;
                    ratio = points / totalPoints;
                }
            }
        }

        ratioEl.innerHTML = pad(Math.floor(ratio * 100)) + "%";
    },

    get_coord = function (event) {
        "use strict";
        var x = event.touches[0].clientX - containerX,
            y = event.touches[0].clientY - containerY;
        return [2 * x, 2 * y];
    },

    start_path = function (event) {
        "use strict";

        if (!didWipe) {
            ga('send', 'event', 'wipe', 'start');
            didWipe = true;
        }

        var coord = get_coord(event);
        event.preventDefault();
        context.beginPath();
        context.moveTo(coord[0], coord[1]);
    },

    continue_path = function (event) {
        "use strict";
        event.preventDefault();
        var coord = get_coord(event);
        console.log(coord);
        context.lineTo(coord[0], coord[1]);
        mark(coord[0], coord[1]);
        context.stroke();
    },

    hide_cta = function () {
        "use strict";
        ctaEl.style.display = "none";
    },

    hundredths = 0,

    showResults = function (seconds) {
        "use strict";
        ga('send', 'event', 'results', 'shown');
        resultsEl.style.display = 'block';
        totalSecondsEl.innerHTML = seconds;
        if (seconds > 5) {
            conclusionEl.innerHTML = "Das geht noch besser.";
        }
        setTimeout(function () {
            logoEl.style.display = 'block';
            dasWarenEl.style["-webkit-transform"] = "scale(1)";
            dasWarenEl.style.opacity = 1;
            totalSecondsEl.style["-webkit-transform"] = "scale(1)";
            totalSecondsEl.style.opacity = 1;
            sekunden.style["-webkit-transform"] = "scale(1)";
            conclusionEl.style["-webkit-transform"] = "scale(1)";
            conclusionEl.style.opacity = 1;
            sekunden.style.opacity = 1;
            whiteLayerEl.style.opacity = 1;
            buttonEl.style.display = 'block';
            buttonEl.style.opacity = 1;
            logoEl.style.opacity = 1;
            kabelBwEl.style.opacity = 1;
            buttonEl.style["pointer-events"] = "auto";
            containerEl.addEventListener("touchstart", function () {
                ga('send', 'event', 'button', 'click');
                window.open(buttonEl.href);
            });
        }, 100);
    },

    setTime = function () {
        "use strict";
        var h = parseInt(hundredths % 100, 10),
            s = parseInt((hundredths / 100) % 60, 10),
            m = parseInt((hundredths / 100) / 60, 10);

        if (ratio > 0.5) {
            clearInterval(interval);
            showResults(s);
            return;
        }

        hundredths = hundredths + 1;

        minutesEl.innerHTML = pad(m);
        secondsEl.innerHTML = pad(s);
        hundredthsEl.innerHTML = pad(h);
    },

    image = new Image();

image.src = "bg_main.jpg";
image.onload = function () {
    "use strict";
    context.strokeStyle = "white";
};

context.lineWidth = 80;

window.addEventListener("load", function () {
    "use strict";

    window.addEventListener("touchmove", function(event) {
        event.preventDefault();
    });

    setTimeout(function () {
        window.scrollTo(0, 1);
    }, 0);

    // containerEl.style.height = screenHeight - 64 + "px";
    containerX = window.innerWidth / 2 - containerEl.offsetWidth / 2;
    containerY = (window.innerHeight / 2 - containerEl.offsetHeight / 2) < 0 ? 0 : (window.innerHeight / 2 - containerEl.offsetHeight / 2);
    containerEl.style.left = containerX + "px";
    containerEl.style.top = containerY + "px";
    logoEl.style.left = window.innerWidth / 2 - logoEl.offsetWidth / 2 + "px";
    bottomEl.style.left = window.innerWidth / 2 - bottomEl.offsetWidth / 2 + "px";

    if (get_param("unity") === "true") {
        kabelBwEl.src = "unity-media-logo.png";
        buttonEl.href = "http://ad.mo.doubleclick.net/dartproxy/dfa.tracker.handler?k=272691958;98002151;o";
    } else {
        buttonEl.href = "http://ad.mo.doubleclick.net/dartproxy/dfa.tracker.handler?k=272693793;97986160;h";
    }

    ctaEl.style.display = "block";
    timerEl.style.display = "block";
    erasableEl.style.opacity = initialOpacity;
    erasableEl.style["-webkit-transition"] = "";
    erasableEl.addEventListener("touchmove", continue_path);
    erasableEl.addEventListener("touchmove", hide_cta);
    erasableEl.addEventListener("touchstart", start_path);
    interval = setInterval(setTime, 10);
});
		</script>
	</body>
</html>