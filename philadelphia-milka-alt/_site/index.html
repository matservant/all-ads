<!DOCTYPE html>
<html lang="en">
<head>
	<title>Philadelphia Milka</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="user-scalable=no, width=300" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<style type="text/css">
html {
	height: 100%;
}

body {
	margin: 0;
	padding: 0;
	font-family: nokia-pure-text, arial, sans-serif;
	color: white;
	font-weight: 300;
	min-height: 100px;
	width: 300px;
}

#background {
	position: absolute;
	top: 0;
	background-image: url(assets/background.jpg);
	background-size: 320px 548px;
	height: 548px;
	width: 320px;
}

#knife {
	width: 185px;
	position: absolute;
	top: -32px;
	left: 60px;
}

#video {
	width: 340px;
	height: 200px;
	position: absolute;
	top: -30px;
	left: -20px;
}

.frame {
	position: absolute;
	top: 0;
	left: 0;
	width: 300px;
}

.frame img {
	width: 100%;
}

.scene {
	position: absolute;
	top: 0;
	left: 0;
	width: 300px;
	height: 100px;
	overflow: hidden;
	-webkit-transition: opacity 0.5s ease-in-out;
}

#scene-2 {
	background-color: white;
	opacity: 0;
}

#scene-2 p {
	color: blue;
	width: 200px;
	margin-left: 60px;
	text-align: center;
	font-size: 18px;
}

.little {
	width: 70px;
	position: absolute;
	top: 25px;
	left: 11px;
	z-index: 1000;
	opacity: 0.8;
}

#scene-3 {
	display: none;
	opacity: 0;
}

#scene-1 img {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	-webkit-transition: opacity 1s ease-in-out;
}

#pic-2 {
	opacity: 0;
}

#pic-3 {
	opacity: 0;
}

#cta {
	width: 198px;
	position: absolute;
	top: 21px;
	right: 10px;
}

@-webkit-keyframes shake-right-arrow {
	50% { -webkit-transform: translate(-10px, 0); }
	100% { -webkit-transform: translate(0, 0); }
}

#scene-4 {
	-webkit-transition: opacity 1s ease-in-out;
	display: none;
	background-color: white;
	opacity: 0;
}

#jetzt {
	display: block;
	margin-top: 21px;
	margin-left: 94px;
	width: 184px;
}

#right-arrow {
	-webkit-animation: shake-right-arrow 1s ease-out 0s;
	-webkit-animation-fill-mode: forwards;
	-webkit-animation-iteration-count: infinite;
	position: absolute;
	left: 50px;
	top: 5px;
	font-size: 30px;
}

#werbung {
	position: absolute;
	top: 233px;
	left: 273px;
	color: black;
}

#barcoo {
	width: 320px;
	position: absolute;
	left: 0;
	top: 548px;
}

img.movie000 { width: 300px; height: 100px; background: url(assets/movie.jpg) 0px 0px no-repeat; }
img.movie001 { width: 300px; height: 100px; background: url(assets/movie.jpg) -300px 0px no-repeat; }
img.movie002 { width: 300px; height: 100px; background: url(assets/movie.jpg) -600px 0px no-repeat; }
img.movie003 { width: 300px; height: 100px; background: url(assets/movie.jpg) -900px 0px no-repeat; }
img.movie004 { width: 300px; height: 100px; background: url(assets/movie.jpg) -1200px 0px no-repeat; }
img.movie005 { width: 300px; height: 100px; background: url(assets/movie.jpg) -1500px 0px no-repeat; }
img.movie006 { width: 300px; height: 100px; background: url(assets/movie.jpg) -1800px 0px no-repeat; }
img.movie007 { width: 300px; height: 100px; background: url(assets/movie.jpg) -2100px 0px no-repeat; }
img.movie008 { width: 300px; height: 100px; background: url(assets/movie.jpg) -2400px 0px no-repeat; }
img.movie009 { width: 300px; height: 100px; background: url(assets/movie.jpg) -2700px 0px no-repeat; }
img.movie010 { width: 300px; height: 100px; background: url(assets/movie.jpg) -3000px 0px no-repeat; }
img.movie011 { width: 300px; height: 100px; background: url(assets/movie.jpg) -3300px 0px no-repeat; }
img.movie012 { width: 300px; height: 100px; background: url(assets/movie.jpg) -3600px 0px no-repeat; }
img.movie013 { width: 300px; height: 100px; background: url(assets/movie.jpg) -3900px 0px no-repeat; }
img.movie014 { width: 300px; height: 100px; background: url(assets/movie.jpg) -4200px 0px no-repeat; }
img.movie015 { width: 300px; height: 100px; background: url(assets/movie.jpg) -4500px 0px no-repeat; }
img.movie016 { width: 300px; height: 100px; background: url(assets/movie.jpg) -4800px 0px no-repeat; }
img.movie017 { width: 300px; height: 100px; background: url(assets/movie.jpg) -5100px 0px no-repeat; }
img.movie018 { width: 300px; height: 100px; background: url(assets/movie.jpg) -5400px 0px no-repeat; }
img.movie019 { width: 300px; height: 100px; background: url(assets/movie.jpg) -5700px 0px no-repeat; }
img.movie020 { width: 300px; height: 100px; background: url(assets/movie.jpg) -6000px 0px no-repeat; }
img.movie021 { width: 300px; height: 100px; background: url(assets/movie.jpg) -6300px 0px no-repeat; }
img.movie022 { width: 300px; height: 100px; background: url(assets/movie.jpg) -6600px 0px no-repeat; }
img.movie023 { width: 300px; height: 100px; background: url(assets/movie.jpg) -6900px 0px no-repeat; }
img.movie024 { width: 300px; height: 100px; background: url(assets/movie.jpg) -7200px 0px no-repeat; }
img.movie025 { width: 300px; height: 100px; background: url(assets/movie.jpg) -7500px 0px no-repeat; }
img.movie026 { width: 300px; height: 100px; background: url(assets/movie.jpg) -7800px 0px no-repeat; }
img.movie027 { width: 300px; height: 100px; background: url(assets/movie.jpg) -8100px 0px no-repeat; }
img.movie028 { width: 300px; height: 100px; background: url(assets/movie.jpg) -8400px 0px no-repeat; }
img.movie029 { width: 300px; height: 100px; background: url(assets/movie.jpg) -8700px 0px no-repeat; }
img.movie030 { width: 300px; height: 100px; background: url(assets/movie.jpg) -9000px 0px no-repeat; }
img.movie031 { width: 300px; height: 100px; background: url(assets/movie.jpg) -9300px 0px no-repeat; }
img.movie032 { width: 300px; height: 100px; background: url(assets/movie.jpg) -9600px 0px no-repeat; }
img.movie033 { width: 300px; height: 100px; background: url(assets/movie.jpg) -9900px 0px no-repeat; }
img.movie034 { width: 300px; height: 100px; background: url(assets/movie.jpg) -10200px 0px no-repeat; }
img.movie035 { width: 300px; height: 100px; background: url(assets/movie.jpg) -10500px 0px no-repeat; }
img.movie036 { width: 300px; height: 100px; background: url(assets/movie.jpg) -10800px 0px no-repeat; }
img.movie037 { width: 300px; height: 100px; background: url(assets/movie.jpg) -11100px 0px no-repeat; }
img.movie038 { width: 300px; height: 100px; background: url(assets/movie.jpg) -11400px 0px no-repeat; }
img.movie039 { width: 300px; height: 100px; background: url(assets/movie.jpg) -11700px 0px no-repeat; }
img.movie040 { width: 300px; height: 100px; background: url(assets/movie.jpg) -12000px 0px no-repeat; }
img.movie041 { width: 300px; height: 100px; background: url(assets/movie.jpg) -12300px 0px no-repeat; }
img.movie042 { width: 300px; height: 100px; background: url(assets/movie.jpg) -12600px 0px no-repeat; }
img.movie043 { width: 300px; height: 100px; background: url(assets/movie.jpg) -12900px 0px no-repeat; }
img.movie044 { width: 300px; height: 100px; background: url(assets/movie.jpg) -13200px 0px no-repeat; }
img.movie045 { width: 300px; height: 100px; background: url(assets/movie.jpg) -13500px 0px no-repeat; }
img.movie046 { width: 300px; height: 100px; background: url(assets/movie.jpg) -13800px 0px no-repeat; }
img.movie047 { width: 300px; height: 100px; background: url(assets/movie.jpg) -14100px 0px no-repeat; }
img.movie048 { width: 300px; height: 100px; background: url(assets/movie.jpg) -14400px 0px no-repeat; }
img.movie049 { width: 300px; height: 100px; background: url(assets/movie.jpg) -14700px 0px no-repeat; }
img.movie050 { width: 300px; height: 100px; background: url(assets/movie.jpg) -15000px 0px no-repeat; }
img.movie051 { width: 300px; height: 100px; background: url(assets/movie.jpg) -15300px 0px no-repeat; }
img.movie052 { width: 300px; height: 100px; background: url(assets/movie.jpg) -15600px 0px no-repeat; }
img.movie053 { width: 300px; height: 100px; background: url(assets/movie.jpg) -15900px 0px no-repeat; }
img.movie054 { width: 300px; height: 100px; background: url(assets/movie.jpg) -16200px 0px no-repeat; }
img.movie055 { width: 300px; height: 100px; background: url(assets/movie.jpg) -16500px 0px no-repeat; }
img.movie056 { width: 300px; height: 100px; background: url(assets/movie.jpg) -16800px 0px no-repeat; }
img.movie057 { width: 300px; height: 100px; background: url(assets/movie.jpg) -17100px 0px no-repeat; }
img.movie058 { width: 300px; height: 100px; background: url(assets/movie.jpg) -17400px 0px no-repeat; }
img.movie059 { width: 300px; height: 100px; background: url(assets/movie.jpg) -17700px 0px no-repeat; }
img.movie060 { width: 300px; height: 100px; background: url(assets/movie.jpg) -18000px 0px no-repeat; }
img.movie061 { width: 300px; height: 100px; background: url(assets/movie.jpg) -18300px 0px no-repeat; }
img.movie062 { width: 300px; height: 100px; background: url(assets/movie.jpg) -18600px 0px no-repeat; }
img.movie063 { width: 300px; height: 100px; background: url(assets/movie.jpg) -18900px 0px no-repeat; }
img.movie064 { width: 300px; height: 100px; background: url(assets/movie.jpg) -19200px 0px no-repeat; }
img.movie065 { width: 300px; height: 100px; background: url(assets/movie.jpg) -19500px 0px no-repeat; }
img.movie066 { width: 300px; height: 100px; background: url(assets/movie.jpg) -19800px 0px no-repeat; }
img.movie067 { width: 300px; height: 100px; background: url(assets/movie.jpg) -20100px 0px no-repeat; }
img.movie068 { width: 300px; height: 100px; background: url(assets/movie.jpg) -20400px 0px no-repeat; }
img.movie069 { width: 300px; height: 100px; background: url(assets/movie.jpg) -20700px 0px no-repeat; }
img.movie070 { width: 300px; height: 100px; background: url(assets/movie.jpg) -21000px 0px no-repeat; }
img.movie071 { width: 300px; height: 100px; background: url(assets/movie.jpg) -21300px 0px no-repeat; }
img.movie072 { width: 300px; height: 100px; background: url(assets/movie.jpg) -21600px 0px no-repeat; }
img.movie073 { width: 300px; height: 100px; background: url(assets/movie.jpg) -21900px 0px no-repeat; }
img.movie074 { width: 300px; height: 100px; background: url(assets/movie.jpg) -22200px 0px no-repeat; }
img.movie075 { width: 300px; height: 100px; background: url(assets/movie.jpg) -22500px 0px no-repeat; }
img.movie076 { width: 300px; height: 100px; background: url(assets/movie.jpg) -22800px 0px no-repeat; }
img.movie077 { width: 300px; height: 100px; background: url(assets/movie.jpg) -23100px 0px no-repeat; }
img.movie078 { width: 300px; height: 100px; background: url(assets/movie.jpg) -23400px 0px no-repeat; }
img.movie079 { width: 300px; height: 100px; background: url(assets/movie.jpg) -23700px 0px no-repeat; }
img.movie080 { width: 300px; height: 100px; background: url(assets/movie.jpg) -24000px 0px no-repeat; }
img.movie081 { width: 300px; height: 100px; background: url(assets/movie.jpg) -24300px 0px no-repeat; }
img.movie082 { width: 300px; height: 100px; background: url(assets/movie.jpg) -24600px 0px no-repeat; }
img.movie083 { width: 300px; height: 100px; background: url(assets/movie.jpg) -24900px 0px no-repeat; }
img.movie084 { width: 300px; height: 100px; background: url(assets/movie.jpg) -25200px 0px no-repeat; }
img.movie085 { width: 300px; height: 100px; background: url(assets/movie.jpg) -25500px 0px no-repeat; }
img.movie086 { width: 300px; height: 100px; background: url(assets/movie.jpg) -25800px 0px no-repeat; }
img.movie087 { width: 300px; height: 100px; background: url(assets/movie.jpg) -26100px 0px no-repeat; }
img.movie088 { width: 300px; height: 100px; background: url(assets/movie.jpg) -26400px 0px no-repeat; }
img.movie089 { width: 300px; height: 100px; background: url(assets/movie.jpg) -26700px 0px no-repeat; }
img.movie090 { width: 300px; height: 100px; background: url(assets/movie.jpg) -27000px 0px no-repeat; }
img.movie091 { width: 300px; height: 100px; background: url(assets/movie.jpg) -27300px 0px no-repeat; }
img.movie092 { width: 300px; height: 100px; background: url(assets/movie.jpg) -27600px 0px no-repeat; }
img.movie093 { width: 300px; height: 100px; background: url(assets/movie.jpg) -27900px 0px no-repeat; }
img.movie094 { width: 300px; height: 100px; background: url(assets/movie.jpg) -28200px 0px no-repeat; }
img.movie095 { width: 300px; height: 100px; background: url(assets/movie.jpg) -28500px 0px no-repeat; }
img.movie096 { width: 300px; height: 100px; background: url(assets/movie.jpg) -28800px 0px no-repeat; }
img.movie097 { width: 300px; height: 100px; background: url(assets/movie.jpg) -29100px 0px no-repeat; }
img.movie098 { width: 300px; height: 100px; background: url(assets/movie.jpg) -29400px 0px no-repeat; }
img.movie099 { width: 300px; height: 100px; background: url(assets/movie.jpg) -29700px 0px no-repeat; }
img.movie100 { width: 300px; height: 100px; background: url(assets/movie.jpg) -30000px 0px no-repeat; }
img.movie101 { width: 300px; height: 100px; background: url(assets/movie.jpg) -30300px 0px no-repeat; }
img.movie102 { width: 300px; height: 100px; background: url(assets/movie.jpg) -30600px 0px no-repeat; }
img.movie103 { width: 300px; height: 100px; background: url(assets/movie.jpg) -30900px 0px no-repeat; }

img.extend0 { width: 300px; height: 100px; background: url(assets/extend.jpg) 0px 0px no-repeat; }
img.extend1 { width: 300px; height: 100px; background: url(assets/extend.jpg) -300px 0px no-repeat; }
img.extend10 { width: 300px; height: 100px; background: url(assets/extend.jpg) -600px 0px no-repeat; }
img.extend11 { width: 300px; height: 100px; background: url(assets/extend.jpg) -900px 0px no-repeat; }
img.extend12 { width: 300px; height: 100px; background: url(assets/extend.jpg) -1200px 0px no-repeat; }
img.extend13 { width: 300px; height: 100px; background: url(assets/extend.jpg) -1500px 0px no-repeat; }
img.extend14 { width: 300px; height: 100px; background: url(assets/extend.jpg) -1800px 0px no-repeat; }
img.extend15 { width: 300px; height: 100px; background: url(assets/extend.jpg) -2100px 0px no-repeat; }
img.extend16 { width: 300px; height: 100px; background: url(assets/extend.jpg) -2400px 0px no-repeat; }
img.extend17 { width: 300px; height: 100px; background: url(assets/extend.jpg) -2700px 0px no-repeat; }
img.extend18 { width: 300px; height: 100px; background: url(assets/extend.jpg) -3000px 0px no-repeat; }
img.extend19 { width: 300px; height: 100px; background: url(assets/extend.jpg) -3300px 0px no-repeat; }
img.extend2 { width: 300px; height: 100px; background: url(assets/extend.jpg) -3600px 0px no-repeat; }
img.extend20 { width: 300px; height: 100px; background: url(assets/extend.jpg) -3900px 0px no-repeat; }
img.extend21 { width: 300px; height: 100px; background: url(assets/extend.jpg) -4200px 0px no-repeat; }
img.extend22 { width: 300px; height: 100px; background: url(assets/extend.jpg) -4500px 0px no-repeat; }
img.extend23 { width: 300px; height: 100px; background: url(assets/extend.jpg) -4800px 0px no-repeat; }
img.extend24 { width: 300px; height: 100px; background: url(assets/extend.jpg) -5100px 0px no-repeat; }
img.extend25 { width: 300px; height: 100px; background: url(assets/extend.jpg) -5400px 0px no-repeat; }
img.extend26 { width: 300px; height: 100px; background: url(assets/extend.jpg) -5700px 0px no-repeat; }
img.extend27 { width: 300px; height: 100px; background: url(assets/extend.jpg) -6000px 0px no-repeat; }
img.extend28 { width: 300px; height: 100px; background: url(assets/extend.jpg) -6300px 0px no-repeat; }
img.extend29 { width: 300px; height: 100px; background: url(assets/extend.jpg) -6600px 0px no-repeat; }
img.extend3 { width: 300px; height: 100px; background: url(assets/extend.jpg) -6900px 0px no-repeat; }
img.extend30 { width: 300px; height: 100px; background: url(assets/extend.jpg) -7200px 0px no-repeat; }
img.extend31 { width: 300px; height: 100px; background: url(assets/extend.jpg) -7500px 0px no-repeat; }
img.extend32 { width: 300px; height: 100px; background: url(assets/extend.jpg) -7800px 0px no-repeat; }
img.extend33 { width: 300px; height: 100px; background: url(assets/extend.jpg) -8100px 0px no-repeat; }
img.extend34 { width: 300px; height: 100px; background: url(assets/extend.jpg) -8400px 0px no-repeat; }
img.extend35 { width: 300px; height: 100px; background: url(assets/extend.jpg) -8700px 0px no-repeat; }
img.extend36 { width: 300px; height: 100px; background: url(assets/extend.jpg) -9000px 0px no-repeat; }
img.extend37 { width: 300px; height: 100px; background: url(assets/extend.jpg) -9300px 0px no-repeat; }
img.extend38 { width: 300px; height: 100px; background: url(assets/extend.jpg) -9600px 0px no-repeat; }
img.extend39 { width: 300px; height: 100px; background: url(assets/extend.jpg) -9900px 0px no-repeat; }
img.extend4 { width: 300px; height: 100px; background: url(assets/extend.jpg) -10200px 0px no-repeat; }
img.extend40 { width: 300px; height: 100px; background: url(assets/extend.jpg) -10500px 0px no-repeat; }
img.extend41 { width: 300px; height: 100px; background: url(assets/extend.jpg) -10800px 0px no-repeat; }
img.extend5 { width: 300px; height: 100px; background: url(assets/extend.jpg) -11100px 0px no-repeat; }
img.extend6 { width: 300px; height: 100px; background: url(assets/extend.jpg) -11400px 0px no-repeat; }
img.extend7 { width: 300px; height: 100px; background: url(assets/extend.jpg) -11700px 0px no-repeat; }
img.extend8 { width: 300px; height: 100px; background: url(assets/extend.jpg) -12000px 0px no-repeat; }
img.extend9 { width: 300px; height: 100px; background: url(assets/extend.jpg) -12300px 0px no-repeat; }


	</style>
</head>
<body id="ad">
	<script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-39490892-1']);
      _gaq.push(['_trackPageview']);

      (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <div id="scene-1" class="scene">
	<div id="movie"></div>
</div>

<div id="scene-2" class="scene">
	<img id="cta" src="assets/cta.png" alt="Streichzart mit Philadelphia Milka jetzt ausprobieren!"/>
</div>
<div id="scene-3" class="scene">
	<img id="bread" src="assets/bread.jpg">
		<div id="extend-frames" style="display: none;"></div>
	<img id="knife" src="assets/knife2.png">
	<p id="right-arrow">→</p>
</div>
<img id="logo" src="assets/little.png" class="little"/>
<div id="scene-4" class="scene">
	<img id="jetzt" src="assets/jetzt.png"/>
</div>
<img 
<p id="werbung">-w-</p>
<img src="assets/extend.jpg" style="display: none;"/>
<img src="assets/movie.jpg" style="display: none;"/>

    <script>
		/*jslint browser: true, devel: true, nomen: true*/
/*global _gaq*/

var YOC = {};

YOC.view = function (spec, my) {
    'use strict';

    var that = {},
        el = document.getElementById(spec.id),
        subviews = [],
        target = spec.target;

    my = my || {};

    that.set_hidden = function (should_hide) {
        if (should_hide) {
            el.style.display = 'none';
        } else {
            el.style.display = 'block';
        }
    };

    that.set_transparent = function (should_be_transparent) {
        if (should_be_transparent) {
            el.style.opacity = 0;
        } else {
            el.style.opacity = 1;
        }
    };

    that.add_subview = function (view) {
        subviews.push(view);
    };

    that.get_el = function () {
        return el;
    };

    that.get_subviews = function () {
        return subviews;
    };

    that.set_target = function (t) {
        target = t;
    };

    that.get_target = function () {
        return target;
    };

    that.click = function (event) {
        event.stopPropagation();
        if (target && target.hasOwnProperty('view_did_click')) {
            target.view_did_click(that, event);
        }
    };

    el.addEventListener('click', that.click);

    return that;
};

YOC.movieView = function (spec, my) {
    'use strict';

    var that = YOC.view(spec, my),

        pad = function (num, size) {
            var s = "000" + num;
            return s.substr(s.length - size);
        },

        showFrame = function (frame, delay) {
            setTimeout(function () {
                frame.style.display = 'block';

                if (that.get_el().lastChild === frame && that.get_target() && that.get_target().hasOwnProperty('movie_did_finish')) {
                    that.get_target().movie_did_finish(that);
                }
            }, delay);
        },

        backward = function () {
            var i, frames = that.get_el().children;
            for (i = 41; i > 0; i = i - 1) {
                if (frames[i].style.display === 'block') {
                    frames[i].style.display = 'none';
                    break;
                }
            }
        },

        forward = function () {
            var i, frames = that.get_el().children;
            for (i = 0; i < frames.length; i = i + 1) {
                if (frames[i].style.display === 'none') {
                    frames[i].style.display = 'block';
                    break;
                }
            }
        },

        rewind = function () {
            var i, frames = this.get_el().children;
            for (i = 0; i < frames.length; i = i + 1) {
                frames[i].style.display = 'none';
            }

            frames[0].style.display = 'block';
        },

        load = function (spec) {
            var i, img, firstChild;

            for (i = 0; i <= spec.frames; i = i + 1) {
                img = document.createElement('img');
                img.src = 'assets/s.gif';
                if (spec.pad && typeof spec.pad === 'number') {
                    img.className = spec.prefix + pad(i, spec.pad);
                } else {
                    img.className = spec.prefix + i;
                }

                img.id = 'frame-' + i;
                img.className = img.className + ' frame';
                img.style.display = 'none';
                that.get_el().appendChild(img);
            }

            firstChild = that.get_el().firstChild;
            while (firstChild !== null && firstChild.nodeType === 3) {
                firstChild = firstChild.nextSibling;
            }
            firstChild.style.display = 'block';
        },

        play = function () {
            var i,
                frames = that.get_el().children;

            for (i = 0; i < frames.length; i = i + 1) {
                showFrame(frames[i], i * 50, frames.length);
            }
        };

    that.load = load;
    that.play = play;
    that.forward = forward;
    that.backward = backward;
    that.rewind = rewind;

    return that;
};

YOC.draggableView = function (spec, my) {
    'use strict';
    var that = YOC.view(spec, my),
        touchmove = function (event) {
            var x = event.touches[0].clientX,
                target = that.get_target();

            if (that.get_el().id === 'knife') {
                that.get_el().style.left = x - 70 + 'px';
            }

            if (target && target.hasOwnProperty('draggable_view_did_drag')) {
                target.draggable_view_did_drag(that, event);
            }
        },

        touchstart = function (event) {
            var target = that.get_target();
            if (target && target.hasOwnProperty('draggable_view_will_drag')) {
                target.draggable_view_will_drag(that, event);
            }
        };

    that.get_el().addEventListener('touchmove', touchmove);
    that.get_el().addEventListener('touchstart', touchstart);
    return that;
};

YOC.viewController = function (my) {
    'use strict';

    var that = {},
        outlets = {},

        add_outlet = function (spec) {
            outlets[spec.name] = spec.dest;
        },

        get_outlet = function (name) {
            return outlets[name];
        },

        track = function (category, action, opt_label, opt_value, opt_noninteraction) {
            _gaq.push(['_trackEvent', category, action, opt_label, opt_value, opt_noninteraction]);
            console.log('Tracking. Category = ' + category + ', action = ' + action);
        };

    my = my || {};

    that.add_outlet = add_outlet;
    that.get_outlet = get_outlet;
    that.track = track;

    return that;
};

		/*jslint browser: true, devel: true*/
/*global YOC*/

var PM = {};

PM.viewController = function (spec, my) {
    'use strict';

    var that = YOC.viewController(spec, my),

        show_jetzt_clicken = function () {
            that.get_outlet('logo').set_hidden(false);
            document.getElementById('scene-4').style.display = 'block';
            document.getElementById('scene-4').style.opacity = 0.7;
        },

        view_did_click = function (view) {
            if (view === that.get_outlet('cta')) {
                that.track('First CTA: Probiere jetzt...', 'Click');
                that.get_outlet('sceneThree').set_hidden(false);
                that.get_outlet('sceneThree').set_transparent(false);
                that.get_outlet('cta').set_hidden(true);
                that.get_outlet('logo').set_hidden(true);
            } else if (view === that.get_outlet('link')) {
                that.track('Second CTA: Zum Verlieben', 'Click');
                var a = document.createElement('a'),
                    dispatch = document.createEvent("HTMLEvents"),
                    url = 'http://bit.ly/ZFe92j';
                a.href = url;
                a.target = '_blank';
                dispatch.initEvent('click', true, true);
                a.dispatchEvent(dispatch);
            } else if (view === that.get_outlet('logo')) {
                that.track('Left logo', 'Click');
            }
        },

        movie_did_finish = function (movie) {
            if (movie.get_el().id === 'movie') {
                that.track('Intro movie', 'Stop playing');
                that.get_outlet('sceneTwo').set_transparent(false);
            }
        },

        draggable_view_did_drag = function (view) {
            var x = view.get_el().offsetLeft || parseInt(view.get_el().style.left, 10);

            if (x >= 113) {
                that.get_outlet('extendView').set_hidden(false);
                view.set_transparent(true);

                if (x > that.prevX) {
                    that.get_outlet('extendView').forward();
                } else {
                    that.get_outlet('extendView').backward();
                }
            } else {
                view.set_transparent(false);
                that.get_outlet('extendView').set_hidden(true);
                that.get_outlet('extendView').rewind();
            }

            that.prevX = x;
        },

        draggable_view_will_drag = function () {
            that.track('Knife', 'Start dragging');
            that.get_outlet('arrow').set_hidden(true);
            setTimeout(show_jetzt_clicken, 4000);
        },

        view_did_load = function () {
            that.get_outlet('extendView').set_hidden(true);
            that.track('Intro movie', 'Start playing', null, null, true);
            that.get_outlet('movie').play();
        };

    my = my || {};

    that.view_did_load = view_did_load;
    that.movie_did_finish = movie_did_finish;
    that.draggable_view_did_drag = draggable_view_did_drag;
    that.draggable_view_will_drag = draggable_view_will_drag;
    that.view_did_click = view_did_click;

    return that;
};

window.onload = function () {
    'use strict';

    var viewController = PM.viewController(),
        logoView = YOC.view({id: 'logo', target: viewController}),
        ctaView = YOC.view({id: 'cta', target: viewController}),
        sceneTwoView = YOC.view({id: 'scene-2', target: viewController}),
        sceneThreeView = YOC.view({id: 'scene-3', target: viewController}),
        knifeView = YOC.draggableView({id: 'knife', target: viewController}),
        extendView = YOC.movieView({id: 'extend-frames', target: viewController}),
        arrowView = YOC.movieView({id: 'right-arrow', target: viewController}),
        movie = YOC.movieView({id: 'movie', target: viewController}),
        link = YOC.view({id: 'scene-4', target: viewController}),

        prevent_scroll = function () {
            document.addEventListener('touchmove', function () {
                event.preventDefault();
            });
        };

    movie.load({prefix: 'movie', frames: 103, pad: 3});
    extendView.load({prefix: 'extend', frames: 41});

    viewController.add_outlet({name: 'movie', dest: movie});
    viewController.add_outlet({name: 'cta', dest: ctaView});
    viewController.add_outlet({name: 'logo', dest: logoView});
    viewController.add_outlet({name: 'sceneTwo', dest: sceneTwoView});
    viewController.add_outlet({name: 'sceneThree', dest: sceneThreeView});
    viewController.add_outlet({name: 'knife', dest: knifeView});
    viewController.add_outlet({name: 'extendView', dest: extendView});
    viewController.add_outlet({name: 'arrow', dest: arrowView});
    viewController.add_outlet({name: 'link', dest: link});

    setTimeout(function () {
        window.scrollTo(0, 1);
        viewController.view_did_load();
    }, 1000);

    prevent_scroll();
};
	</script>
</body>
