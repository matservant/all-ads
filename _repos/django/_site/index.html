<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Django Unchained</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="user-scalable=no, width=device-width" />
		<meta http-equiv="Cache-Control" content="no-cache" />
		<style type="text/css">
@-webkit-keyframes swing {
	10% { -webkit-transform: rotateX(0) rotateY(22deg) }
	50% { -webkit-transform: rotateX(8deg) rotateY(-10deg) }
	90% { -webkit-transform: rotateX(-8deg) rotateY(5deg) }
	98% { -webkit-transform: rotateX(0) rotateY(0) }
}

@-webkit-keyframes open {
	from { -webkit-transform: rotateX(0) rotateY(0) }
	to { -webkit-transform: rotateX(0) rotateY(270deg) }
}

@-webkit-keyframes shake {
	0% { -webkit-transform: translate(2px, 1px) rotate(1deg) scale(1);}
	10% { -webkit-transform: translate(-1px, -2px) rotate(0deg) scale(1.01); }
	20% { -webkit-transform: translate(-3px, 0px) rotate(-1deg) scale(1.02); }
	30% { -webkit-transform: translate(0px, 2px) rotate(0deg) scale(1.01); }
	40% { -webkit-transform: translate(1px, -1px) rotate(1deg) scale(1); }
	50% { -webkit-transform: translate(-1px, 2px) rotate(2deg) scale(1.01); }
	60% { -webkit-transform: translate(-3px, 1px) rotate(-1deg) scale(1.02); }
	70% { -webkit-transform: translate(2px, 1px) rotate(-2deg) scale(1.01); }
	80% { -webkit-transform: translate(-1px, -1px) rotate(0deg) scale(1); }
	90% { -webkit-transform: translate(2px, 2px) rotate(1deg) scale(1); }
	100% { -webkit-transform: translate(1px, -2px) rotate(0deg); scale(1)}
}

body {
	margin: 0;
	min-height: 504px;
}

#container {
	height: 120%;
	width: 100%;
	position: absolute;
	top: 0;
	left: 0;
	overflow: hidden;
}

#background {
	height: 100%;
	width: 100%;
	position: absolute;
	top: 0;
	left: 0;
	background-image: url(background.jpg);
	background-size: 100% 100%;
}

#top {
	position: absolute;
	top: 0;
	width: 100%;
}

#middle {
	height: 100%;
}

#bottom {
	position: fixed;
	bottom: 0;
	width: 100%;
}

.hole {
	position: absolute;
	opacity: 0;
	width: 20%;
}

#middle-container {
	height: 14%;
	text-align: center;
	margin-top: 47%;
	position: relative;
}

.ending {
	-webkit-transition: opacity 0.6s ease-in;
	opacity: 0;
}

#doors {
	position: absolute;
	top: 0;
	width: 100%;
	height: 100%;
}

#shoot-container {
	height: 5%;
	text-align: center;
	margin-top: -33%;
	position: relative;
}

#shoot {
	height: 100%;
}

#door-left {
	position: absolute;
	left: 8%;
	top: 42%;
	width: 42%;
	-webkit-transform-origin: left top;
	-webkit-perspective: 500;
	-webkit-animation-fill-mode: forwards;
}

#door-right {
	position: absolute;
	right: 8%;
	top: 42%;
	width: 42%;
	-webkit-transform-origin: right top;
	-webkit-perspective: 500;
	-webkit-animation-fill-mode: forwards;
}

#portal {
	position: absolute;
	top: 0;
	height: 100%;
	width: 100%;
	-webkit-transition: all 2s ease-in;
}

#frame-top {
	position: absolute;
	top: 0;
	width: 100%;
	height: 43px;
}

#frame-left {
	position: absolute;
	top: 42px;
	height: 100%;
	width: 11.9%;
}

#frame-right {
	position: absolute;
	top: 42px;
	right: 0;
	height: 100%;
	width: 11.6%;
}

/* -webkit-transform-origin: left top;
-webkit-transform: rotateX(10deg) rotateY(22deg);
-webkit-perspective: 490px; */
		</style>
	</head>
	<body>
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-41094613-1', 'yoc-ag.github.io');
			ga('send', 'pageview');
		</script>
<div id="container">
	<div id="background" class="ending"></div>
	<img id="top" class="ending" src="top-fs8.png"/>
	<div id="middle-container">
		<img id="middle" class="ending" src="middle-fs8.png"/>
	</div>
	<div id="shoot-container">
		<img id="shoot" src="shoot.png" class="start"/>
	</div>
	<img id="bottom" class="ending" src="bottom-fs8.png"/>
	<div id="portal">
		<img id="frame-top" src="frame-top.jpg"/>
		<img id="frame-left" src="frame-left.jpg"/>
		<img id="frame-right" src="frame-right.jpg"/>
		<img id="door-left" src="door-left-fs8.png"/>
		<img id="door-right" src="door-right-fs8.png"/>
	</div>
</div>
		<script>
/*jslint browser: true, devel: true*/
/*global Audio, ga*/

var containerEl = document.getElementById("container"),
    startEls = document.getElementsByClassName("start"),
    endingEls = document.getElementsByClassName("ending"),
    leftDoorEl = document.getElementById("door-left"),
    rightDoorEl = document.getElementById("door-right"),
    portalEl = document.getElementById("portal"),
    backgroundEl = document.getElementById("background"),

    landingURL = "http://bs.serving-sys.com/BurstingPipe/adServer.bs?cn=tf&c=20&mc=click&pli=6893373&PluID=0&ord=" + new Date().getTime() + "&mb=1&ck=1",
    shotCount = {"door-left": 0, "door-right": 0},
    sound = new Audio("shot.m4a"),

    open_landing_page = function () {
        "use strict";
        var a = document.createElement('a'),
            dispatch = document.createEvent("HTMLEvents");

        a.href = landingURL;
        a.target = '_blank';

        dispatch.initEvent('click', true, true);
        a.dispatchEvent(dispatch);
    },

    show_ending = function () {
        "use strict";
        var i;

        backgroundEl.style.opacity = 1;

        setTimeout(function () {
            for (i = 0; i < endingEls.length; i = i + 1) {
                endingEls[i].style.opacity = 1;
            }

            for (i = 0; i < startEls.length; i = i + 1) {
                startEls[i].style.opacity = 0;
            }

            document.getElementById("door-left").style["-webkit-animation"] = "open 2s";
            document.getElementById("door-right").style["-webkit-animation"] = "open 2s";
            portalEl.style["-webkit-transform"] = "scale(10)";
            portalEl.style.opacity = 0;
            portalEl.style["pointer-events"] = "none";

            document.addEventListener("touchstart", function () {
                ga('send', 'event', 'button', 'click');
                open_landing_page();
            });
        }, 2000);
    },

    shot = function (event) {
        "use strict";

        shotCount[event.target.id] = shotCount[event.target.id] + 1;

        if (shotCount["door-left"] === 3) {
            leftDoorEl.removeEventListener("touchstart", shot);
        }

        if (shotCount["door-left"] === 3) {
            rightDoorEl.removeEventListener("touchstart", shot);
        }

        if (shotCount["door-left"] + shotCount["door-right"] === 3) {
            leftDoorEl.removeEventListener("touchstart", shot);
            rightDoorEl.removeEventListener("touchstart", shot);
            show_ending();
        }

        event.target.style.webkitAnimation = 'none';
        portalEl.style.webkitAnimation = 'none';

        setTimeout(function() {
            event.target.style.webkitAnimation = "swing 1s";
            portalEl.style.webkitAnimation = "shake 0.5s";
            event.target.src = event.target.id + "-" + shotCount[event.target.id] + "-fs8.png";
        }, 10);

        sound.play();
    },

    prevent_scroll = function (event) {
        "use strict";
        event.preventDefault();
    },

    hide_navbar = function () {
        "use strict";

        setTimeout(function () {
            window.scrollTo(0, 1);
        }, 0);
    };

leftDoorEl.addEventListener("touchstart", shot);
rightDoorEl.addEventListener("touchstart", shot);
window.addEventListener("touchmove", prevent_scroll);
window.addEventListener("load", hide_navbar);
		</script>
	</body>
</html>